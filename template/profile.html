{% extends "userBase.html" %}
{% block title %}profile{% endblock %}
{% block content %}
{% if messages %}
    {% for message in messages %}
        <div class="alert" role="alert">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}
<div class="profile-header">
    <!-- Profile picture and user details -->
    <div class="profile-picture">
          
        {% if user_profile.profile_picture %}
        <img src="{{ user_profile.profile_picture.url }}" width="120px" height="100px" alt="Profile Picture" >
    {% else %}
        <div class="profile-placeholder rounded-circle">
            <p>No profile picture available</p>
        </div>
    {% endif %}
    </div>
    <div class="user-details">
        <h2>{{ user_details.username }}</h2>
        <p><strong>Email:</strong> {{ user_details.email }}</p>
        <p><strong>Phone:</strong> {{ user_details.phone }}</p>
    </div>
</div>

<div class="profile-content">
    <h3>User Profile Details</h3>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <label for="profile_picture">Change Profile Picture:</label>
        <input type="file" id="profile_picture" name="profile_picture" accept="image/*">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" value="{{ user_details.username }}" oninput="validateUsername()">
        <span id="usernameError" class="error"></span>

        <label for="phone">Phone Number:</label>
        <input type="text" id="phone" name="phone" value="{{ user_details.phone }}" oninput="validatePhoneNumber()">
        <span id="phoneError" class="error"></span><br>

        
       
        <!-- <label for="address">Address:</label>
        <input type="text" id="address" name="address" value="{{ user_profile.address }}">
        
        <label for="addressline1">Address Line 1:</label>
        <input type="text" id="addressline1" name="addressline1" value="{{ user_profile.addressline1 }}">
        
        <label for="addressline2">Address Line 2:</label>
        <input type="text" id="addressline2" name="addressline2" value="{{ user_profile.addressline2 }}">
        
        <label for="state">State:</label>
        <input type="text" id="state" name="state" value="{{ user_profile.state }}">
        
        <label for="city">City:</label>
        <input type="text" id="city" name="city" value="{{ user_profile.city }}">
        
        <label for="pin_code">Pin Code:</label>
        <input type="text" id="pin_code" name="pin_code" value="{{ user_profile.pin_code }}">
        
        <label for="gender">Gender:</label>
        <input type="text" id="gender" name="gender" value="{{ user_profile.gender }}">
        
        <label for="dob">Date of Birth:</label>
        <input type="date" id="dob" name="dob" value="{{ user_profile.dob|date:'d-m-Y' }}"> -->
        
        <br><input type="submit" value="Save"> 
        <!-- <button><a href="/changepassword">Change Password</a></button> -->
    </form>
</div>
<script>
    function validateUsername() {
        var usernameInput = document.getElementById("username");
        var usernameValue = usernameInput.value.trim();
        var usernameError = document.getElementById("usernameError");
    
        if (usernameValue === "") {
            usernameError.textContent = "Username is required";
            usernameError.style.color = "red";
            usernameInput.classList.add("is-invalid");
            return false;
        }
    
        usernameError.textContent = "";
        usernameInput.classList.remove("is-invalid");
        return true;
    }
    
    function validatePhoneNumber() {
        var phoneInput = document.getElementById("phone");
        var phoneValue = phoneInput.value.trim();
        var phoneError = document.getElementById("phoneError");
    
        var phonePattern = /^[6789]\d{9}$/; // Starts with 6, 7, 8, or 9 and has 10 digits
    
        if (phoneValue === "") {
            phoneError.textContent = "Phone number is required";
            phoneError.style.color = "red";
            phoneInput.classList.add("is-invalid");
            return false;
        }
    
        if (!phonePattern.test(phoneValue)) {
            phoneError.textContent = "Invalid phone number format";
            phoneError.style.color = "red";
            phoneInput.classList.add("is-invalid");
            return false;
        }
    
        phoneError.textContent = "";
        phoneInput.classList.remove("is-invalid");
        return true;
    }
    </script>
<style>
/* Profile Header */
.profile-header {
    display: flex;
    align-items: center;
    padding: 20px;
}

.profile-picture {
    width: 100px;
    height: 100px;
    margin-right: 20px;
    overflow: hidden; /* Ensure the image stays within the circle */
}


/* Circular placeholder for profile picture */
.profile-placeholder {
    width: 100%;
    height: 100%;
    background-color: #ccc; /* Placeholder background color */
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
}

.profile-placeholder p {
    font-size: 16px;
}

.user-details h2 {
    font-size: 24px;
}

.user-details p {
    font-size: 16px;
}
.profile-content {
    padding: 20px;
    border-top: 1px solid #ccc;
    margin-top: 20px;
}

.profile-content h3 {
    font-size: 20px;
    margin-bottom: 10px;
}

.profile-content form label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
}

.profile-content form input[type="text"],
.profile-content form input[type="date"] {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 16px;
}

.profile-content form input[type="file"] {
    margin-top: 10px;
}

.profile-content form input[type="submit"] {
    background-color: #3897f0;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    font-size: 18px;
    cursor: pointer;
}

.profile-content form input[type="submit"]:hover {
    background-color: #2763a3;
}
/* Rest of your existing styles */
</style>
{% endblock content %}