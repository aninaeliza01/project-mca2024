{% extends "adminbase.html" %}
{% block title %}fuel{% endblock %}
{% block content %}
{% if messages %}
    {% for message in messages %}
        <div class="alert" role="alert">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}
<h3 class="mb-3">Fuel</h3>
<form method="POST" id="fuelForm">
    {% csrf_token %}
    <label for="id_fueltype">Fuel Type:</label>
    <input type="text" name="fueltype" id="id_fueltype">
    <span class="error" id="fueltypeError"></span><br>

    <label for="id_price">Price:</label>
    <input type="text" name="price" id="id_price">
    <span class="error" id="priceError"></span><br>

    <button type="submit">Add Fuel</button>
</form>
<div class="table-responsive">
    <h3 class="mb-3">Fuel Records</h3>
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th>Fuel Type</th>
                <th>Price</th>
                <th>Date Recorded</th>
                <th>Actions</th>
                <!-- Add more columns if needed -->
            </tr>
        </thead>
        <tbody>
            {% for fuel in fuels %}
            <tr>
                <form method="POST" action="{% url 'update_fuel' fuel.id %}">
                    {% csrf_token %}
                    <td>{{ fuel.fueltype }}</td>
                    <td>
                        <input type="number" id="price_{{ fuel.id }}" name="price" value="{{ fuel.price }}">
                        
                    </td>
                    <td>{{ fuel.profile_modified_at }}</td>
                    <td>
                        <button type="submit" class="btn btn-danger btn-sm" name="update_fuel" value="{{ fuel.id }}">Update</button>
                        <!-- <a href="{% url 'delete_fuel' fuel.id %}" class="btn btn-danger">Delete</a> -->
                    </td>
                    <!-- Add more columns if needed -->
                </form>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
</div>
<script>
     document.addEventListener("DOMContentLoaded", function() {
    const inputField = document.getElementById('id_fueltype');
    inputField.addEventListener('input', function(event) {
      let enteredValue = event.data;
      if (enteredValue && !/^[A-Za-z]+$/.test(enteredValue)) {
        inputField.value = inputField.value.slice(0, -1);
      }
    });
    
});
document.addEventListener("DOMContentLoaded", function() {
        const inputField = document.getElementById('id_price');
        inputField.addEventListener('input', function(event) {
            let enteredValue = event.data;
            
            if (enteredValue && !/^[0-9.]*$/.test(enteredValue)) {
                inputField.value = inputField.value.replace(/[^0-9.]/g, '');
            }
        });
    });
 
        document.addEventListener("DOMContentLoaded", function() {
            const fuelForm = document.getElementById('fuelForm');
            const fuelTypeField = document.getElementById('id_fueltype');
            const priceField = document.getElementById('id_price');
            const priceError = document.getElementById('priceError');

            fuelTypeField.addEventListener('input', function(event) {
                let enteredValue = event.target.value;
                if (enteredValue && !/^[A-Za-z]+$/.test(enteredValue)) {
                    fuelTypeField.value = fuelTypeField.value.slice(0, -1);
                }
            });

            priceField.addEventListener('input', function(event) {
                let enteredValue = event.target.value.trim();
                if (enteredValue === "0") {
                    priceError.innerText = "Price cannot be zero.";
                    priceField.classList.add("error");
                } else if (!/^(\d{1,4}(\.\d{1,2})?)?$/.test(enteredValue)) {
                    priceError.innerText = "Please enter a valid price with at most 4 digits before the decimal.";
                    priceField.classList.add("error");
                } else {
                    priceError.innerText = "";
                    priceField.classList.remove("error");
                }
            });

            fuelForm.addEventListener('submit', function(event) {
                let enteredPrice = priceField.value.trim();
                if (enteredPrice === "0" || !/^(\d{1,4}(\.\d{1,2})?)?$/.test(enteredPrice)) {
                    event.preventDefault(); // Prevent form submission if price is invalid
                }
                // Additional form submission handling or AJAX call if needed
            });
        });

</script>

<style>
    .alert {
        background-color: #f2dede; /* Background color for alert */
        border: 1px solid #ebccd1; /* Border color for alert */
        color: #a94442; /* Text color for alert */
        padding: 10px; /* Padding inside the alert */
        margin: 10px 0; /* Margin around the alert */
    }
    /* Style the form container */
    form {
        max-width: 400px;
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 10px;
        background-color: #f9f9f9;
    }

    /* Style labels and input fields */
    label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
    }

    input[type="text"],
    input[type="number"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    /* Style error messages */
    .error {
        color: red;
        font-size: 12px;
        margin-top: 5px;
    }

    /* Style the submit button */
    button[type="submit"] {
        background-color: #007BFF;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
    }

    button[type="submit"]:hover {
        background-color: #0056b3;
    }

    /* Style the form container */
    .table-responsive {
        margin-top: 20px;
    }
</style>


{% endblock content %}
